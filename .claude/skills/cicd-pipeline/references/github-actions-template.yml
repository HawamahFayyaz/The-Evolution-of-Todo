# GitHub Actions Workflow Template

workflow_structure:
  name: "Workflow Name"
  on:
    - pull_request
    - push
    - schedule
    - workflow_dispatch

  env:
    GLOBAL_VAR: "value"

  jobs:
    job_name:
      runs-on: "ubuntu-latest"
      steps:
        - name: "Step name"
          uses: "action@version"
          with:
            param: "value"

common_actions:
  checkout:
    uses: "actions/checkout@v4"
    description: "Clone repository"

  setup_python:
    uses: "actions/setup-python@v5"
    with:
      python-version: "3.13"
      cache: "pip"

  setup_node:
    uses: "actions/setup-node@v4"
    with:
      node-version: "20"
      cache: "npm"

  docker_login:
    uses: "docker/login-action@v3"
    with:
      registry: "ghcr.io"
      username: "${{ github.actor }}"
      password: "${{ secrets.GITHUB_TOKEN }}"

caching_patterns:
  pip_cache:
    example: |
      - uses: actions/setup-python@v5
        with:
          python-version: '3.13'
          cache: 'pip'
      - run: pip install -r requirements.txt

  npm_cache:
    example: |
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      - run: npm ci

  docker_layer_cache:
    example: |
      - uses: docker/build-push-action@v5
        with:
          cache-from: type=gha
          cache-to: type=gha,mode=max

job_dependencies:
  parallel_jobs:
    description: "Jobs run simultaneously"
    example: |
      jobs:
        lint:
          runs-on: ubuntu-latest
        test:
          runs-on: ubuntu-latest

  sequential_jobs:
    description: "Job waits for another to complete"
    example: |
      jobs:
        build:
          runs-on: ubuntu-latest
        deploy:
          runs-on: ubuntu-latest
          needs: build  # Waits for build to succeed

environments:
  staging:
    name: "staging"
    url: "https://staging.example.com"
    protection_rules:
      - "No approval required"

  production:
    name: "production"
    url: "https://example.com"
    protection_rules:
      - "Require approval from 1 reviewer"
      - "Wait 5 minutes before deployment"

matrix_builds:
  purpose: "Test multiple configurations"
  example: |
    strategy:
      matrix:
        python-version: ['3.12', '3.13']
        os: [ubuntu-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}

conditional_execution:
  if_main_branch:
    example: |
      if: github.ref == 'refs/heads/main'

  if_pr:
    example: |
      if: github.event_name == 'pull_request'

  if_tag:
    example: |
      if: startsWith(github.ref, 'refs/tags/')
